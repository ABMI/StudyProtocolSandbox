DBMS:
sql server

Error:
execute JDBC update query failed in dbSendUpdate (키워드 'THEN' 근처의 구문이 잘못되었습니다.)

SQL:
SELECT ROW_NUMBER() OVER (ORDER BY person_id, cohort_start_date) AS row_id,
	subject_id,

	cohort_definition_id,

	cohort_start_date,
	DATEDIFF(DAY, observation_period_start_date, cohort_start_date) AS days_from_obs_start,
	
		DATEDIFF(DAY, cohort_start_date, cohort_end_date)
	 AS days_to_cohort_end,
	
		DATEDIFF(DAY, cohort_start_date, observation_period_end_date) 
	 AS days_to_obs_end
INTO #cohort_person
FROM (


	SELECT subject_id,
		CASE
			
			WHEN cohort_definition_id = 
				THEN 1
			WHEN cohort_definition_id = 
				THEN 0

			ELSE - 1
		END AS cohort_definition_id,
		cohort_start_date,
		cohort_end_date
	FROM SJ_HTN_combi_package.dbo.exposureTable exposure_table

	WHERE cohort_definition_id IN (, )

		AND (SELECT COUNT(DISTINCT(cohort_definition_id)) 
			 FROM SJ_HTN_combi_package.dbo.exposureTable temp
			 WHERE temp.subject_id = exposure_table.subject_id
			 AND cohort_definition_id IN (, )) = 1
	


	) raw_cohorts

INNER JOIN NHID.dbo.observation_period
	ON subject_id = person_id
WHERE cohort_start_date <= observation_period_end_date
	AND cohort_start_date >= observation_period_start_date
 



R version:
R version 3.3.1 (2016-06-21)

Platform:
x86_64-w64-mingw32

Attached base packages:
- stats
- graphics
- grDevices
- utils
- datasets
- methods
- base

Other attached packages:
- EmpiricalCalibration (1.2.1)
- OhdsiSharing (0.1.1)
- OhdsiRTools (1.1.2)
- SqlRender (1.1.8)
- HypertensionCombination (0.1)
- CohortMethod (2.0.0)
- FeatureExtraction (1.0.2)
- Cyclops (1.2.3)
- DatabaseConnector (1.8.0)
- RJDBC (0.2-5)
- rJava (0.9-8)
- DBI (0.5)
- devtools (1.12.0)